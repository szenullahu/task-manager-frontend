<div class="container mt-4">
  <div class="row g-4">
    <div class="col-lg-4 col-md-6 col-sm-12 pb-3">
      <a routerLink="/tasks/new" class="btn btn-outline-success fw-semibold">Create Task</a>
    </div>
  </div>
  @if (tasks.length === 0) {
    <div class="text-center py-5">
      <h4 class="mb-2">No tasks yet</h4>
      <p class="text-secondary mb-0">Create your first task to get started.</p>
    </div>
  }
  <div class="row g-4">
    @for (task of tasks; track task.id) {
      <div class="col-lg-4 col-md-6 col-sm-12">
        <div class="card h-100 shadow-sm task-hover">
          <div class="card-body d-flex flex-column">
            <!-- Title -->
            <h5 class="fw-bold mb-3">{{ task.title }}</h5>
            <!-- Description -->
            <div class="py-2 border-top border-bottom mb-3">
              <span class="kv-label d-block mb-1">Description</span>
              <p class="text-body mb-0 clamp-3">{{ task.description || 'â€”' }}</p>
            </div>
            <!-- Priority -->
            <div class="kv-row">
              <span class="kv-label">Priority</span>
              <span class="kv-value">
                  @if (task.priority === 'LOW') {
                    <span
                      class="badge rounded-pill bg-success-subtle text-success-emphasis border border-success-subtle">Low</span>
                  }
                @if (task.priority === 'MEDIUM') {
                  <span class="badge rounded-pill bg-warning-subtle text-warning-emphasis border border-warning-subtle">Medium</span>
                }
                @if (task.priority === 'HIGH') {
                  <span class="badge rounded-pill bg-danger-subtle text-danger-emphasis border border-danger-subtle">High</span>
                }
                  </span>
            </div>
            <!-- Status -->
            <div class="kv-row">
              <span class="kv-label">Status</span>
              <span class="kv-value">
                  @if (task.status === 'PENDING') {
                    <span
                      class="badge rounded-pill bg-secondary-subtle text-secondary-emphasis border border-secondary-subtle">
                  Pending
                  </span>
                  }
                @if (task.status === 'IN_PROGRESS') {
                  <span class="badge rounded-pill bg-primary-subtle text-primary-emphasis border border-primary-subtle">
                  In Progress
                  </span>
                }
                @if (task.status === 'COMPLETED') {
                  <span class="badge rounded-pill bg-success-subtle text-success-emphasis border border-success-subtle">
                  Completed
                  </span>
                }
                @if (task.status === 'CANCELLED') {
                  <span class="badge rounded-pill bg-dark-subtle text-dark-emphasis border border-dark-subtle">
                  Cancelled
                  </span>
                }
                  </span>
            </div>
            <!-- Due Date -->
            <div class="kv-row mb-3">
              <span class="kv-label">Due Date</span>
              <span class="kv-value">
                  <span
                    class="badge rounded-pill"
                    [ngClass]="{
                     'bg-danger-subtle text-danger-emphasis border border-danger-subtle': isOverdue(task.dueDate),
                     'bg-warning-subtle text-warning-emphasis border border-warning-subtle': !isOverdue(task.dueDate) && isDueSoon(task.dueDate, 3),
                     'bg-light text-body border border-light-subtle': !isOverdue(task.dueDate) && !isDueSoon(task.dueDate, 3)
                     }"
                  >
                  {{ task.dueDate }}
                  </span>
                  </span>
            </div>
            <!-- Created & Updated -->
            <div class="mb-3 small text-secondary">
              <div class="d-flex align-items-center mb-1">
                <i class="bi bi-clock-history me-2"></i>
                <span>Created:  {{ task.created }}</span>
              </div>
              <div class="d-flex align-items-center">
                <i class="bi bi-arrow-repeat me-2"></i>
                <span>Updated: {{ task.updated }}</span>
              </div>
            </div>
            <!-- Footer actions -->
            <div class="mt-auto pt-2 border-top d-flex justify-content-end gap-2">
              <a [routerLink]="['/tasks', task.id, 'edit']" class="btn btn-sm btn-outline-primary">
                <i class="bi bi-pencil-square me-1"></i> Edit
              </a>
              <button class="btn btn-sm btn-outline-danger" (click)="deleteTask(task.id)">
                <i class="bi bi-trash3 me-1"></i> Delete
              </button>
            </div>
          </div>
        </div>
      </div>
    }
  </div>
</div>
